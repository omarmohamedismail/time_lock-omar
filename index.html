<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Countdown Lock Screen</title>
  <style>
    body {
      margin: 0; height: 100vh; width: 100vw; background: #000;
      display: flex; justify-content: center; align-items: center; flex-direction: column;
      color: #fff; font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      user-select: none; overflow: hidden; text-align: center;
    }
    .setup-box {
      background: rgba(255,255,255,0.08);
      padding: 20px 30px; border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      max-width: 520px; width: 92%;
    }
    .inputs { display: flex; gap: 15px; justify-content: center; margin: 15px 0; flex-wrap: wrap; }
    .inputs label { font-size: 15px; margin-bottom: 6px; display: block; }
    input, button {
      padding: 10px; font-size: 18px; border: none; border-radius: 10px; outline: none;
    }
    input[type="number"] { width: 90px; text-align: center; }
    input[type="color"] { cursor: pointer; height: 44px; width: 80px; border-radius: 10px; }
    button { background: #4CAF50; color: #fff; cursor: pointer; transition: .25s; }
    button:hover { background: #45a049; }
    .time { font-size: 12vw; font-weight: 700; margin-bottom: 18px; letter-spacing: 4px; line-height: 1; }
    .hint { font-size: 4.5vw; opacity: .75; margin-bottom: 10px; }
    .quote { font-size: 3.5vw; opacity: .8; font-style: italic; max-width: 90%; line-height: 1.5; }
    .error { color: #ffb3b3; margin-top: 8px; font-size: 14px; display:none; }
    @media (min-width: 768px) {
      .time { font-size: 120px; }
      .hint { font-size: 22px; }
      .quote { font-size: 20px; }
      .error { font-size: 15px; }
    }
  </style>
</head>
<body>
  <div class="setup-box" id="setup">
    <div style="font-weight:600; margin-bottom:8px;">⏰ اختر الوقت:</div>
    <div class="inputs">
      <div>
        <label>ساعات</label>
        <input type="number" id="hoursInput" value="0" min="0" inputmode="numeric" pattern="[0-9]*"/>
      </div>
      <div>
        <label>دقائق</label>
        <input type="number" id="minutesInput" value="5" min="0" max="59" inputmode="numeric" pattern="[0-9]*"/>
      </div>
      <div>
        <label>لون الخلفية</label>
        <input type="color" id="bgColor" value="#000000" />
      </div>
    </div>
    <button id="startBtn" onclick="startCountdown()">ابدأ</button>
    <div class="error" id="errMsg">من فضلك أدخل وقتًا أكبر من صفر (مثال: 0 ساعة و 3 دقائق).</div>
  </div>

  <div class="time" id="time" style="display:none;">00:00:00</div>
  <div class="hint" id="hint" style="display:none;">اضغط على المسطرة للخروج</div>
  <div class="quote" id="quote" style="display:none;"></div>

  <script>
    let countdown = 0;
    let interval = null;
    let audioCtx = null;

    // ✅ دعم الأرقام العربية والهندية: تحويلها لـ ASCII قبل التحويل لأرقام
    function toAsciiDigits(str) {
      if (typeof str !== 'string') return str;
      return str
        // العربية (٠١٢٣٤٥٦٧٨٩)
        .replace(/[٠-٩]/g, d => String(d.charCodeAt(0) - 1632))
        // الفارسية/الأردية (۰۱۲۳۴۵۶۷۸۹)
        .replace(/[۰-۹]/g, d => String(d.charCodeAt(0) - 1776));
    }
    function toIntSafe(el, clampMax = null) {
      const raw = toAsciiDigits(el.value || "");
      let n = parseInt(raw, 10);
      if (isNaN(n)) n = 0;
      if (n < 0) n = 0;
      if (clampMax !== null && n > clampMax) n = clampMax;
      return n;
    }

    // 📜 30 حكمة لطلبة الثانوية العامة
    const quotes = [
      "من جدّ وجد، ومن زرع حصد.",
      "الوقت كالسيف إن لم تقطعه قطعك.",
      "اطلب العلم من المهد إلى اللحد.",
      "اعمل لدنياك كأنك تعيش أبداً، واعمل لآخرتك كأنك تموت غداً.",
      "لا تؤجل عمل اليوم إلى الغد.",
      "الصديق وقت الضيق.",
      "الحكمة ضالة المؤمن.",
      "القناعة كنز لا يفنى.",
      "درهم وقاية خير من قنطار علاج.",
      "في التأني السلامة وفي العجلة الندامة.",
      "إذا تم العقل نقص الكلام.",
      "لا حياة مع اليأس، ولا يأس مع الحياة.",
      "افعل الخير تجده.",
      "الكلمة الطيبة صدقة.",
      "الجار قبل الدار.",
      "من راقب الناس مات همّاً.",
      "من شبّ على شيء شاب عليه.",
      "ربّ أخ لم تلده أمك.",
      "عثرة القدم ولا عثرة اللسان.",
      "من عاش بوجهين مات لا وجه له.",
      "العلم نور والجهل ظلام.",
      "الصمت حكمة ومنطق قليل.",
      "رحم الله امرأً عرف قدر نفسه.",
      "الصحة تاج على رؤوس الأصحاء.",
      "البحر الهادئ لا يصنع بحّاراً ماهراً.",
      "من لا يَرحم لا يُرحم.",
      "الدنيا ساعة فاجعلها طاعة.",
      "التوفيق من الله، والسعي من العبد.",
      "الابتسامة لغة لا تحتاج إلى ترجمة.",
      "الكذب داء، والصدق دواء."
    ];

    function startCountdown() {
      // اخفاء رسالة الخطأ إن ظهرت
      const err = document.getElementById('errMsg');
      err.style.display = 'none';

      const hours = toIntSafe(document.getElementById('hoursInput'));
      const minutes = toIntSafe(document.getElementById('minutesInput'), 59);

      countdown = (hours * 3600) + (minutes * 60);
      if (countdown <= 0) {
        err.style.display = 'block';
        return;
      }

      if (!audioCtx && (window.AudioContext || window.webkitAudioContext)) {
        const AC = window.AudioContext || window.webkitAudioContext;
        audioCtx = new AC();
      }

      document.body.style.background = document.getElementById('bgColor').value;

      document.getElementById('setup').style.display = "none";
      document.getElementById('time').style.display = "block";
      document.getElementById('hint').style.display = "block";

      // اختر حكمة عشوائية
      const q = quotes[Math.floor(Math.random() * quotes.length)];
      document.getElementById('quote').textContent = q;
      document.getElementById('quote').style.display = "block";

      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen().catch(()=>{});
      }

      updateCountdown();
      clearInterval(interval);
      interval = setInterval(updateCountdown, 1000);
    }

    function updateCountdown() {
      const h = Math.floor(countdown / 3600);
      const m = Math.floor((countdown % 3600) / 60);
      const s = countdown % 60;

      document.getElementById('time').textContent =
        String(h).padStart(2, '0') + ":" +
        String(m).padStart(2, '0') + ":" +
        String(s).padStart(2, '0');

      if (countdown > 0) {
        countdown--;
      } else {
        clearInterval(interval);
        document.getElementById('time').textContent = "00:00:00";
        ringAlarm();
      }
    }

    function ringAlarm() {
      if (navigator.vibrate) navigator.vibrate([200, 120, 200]);

      if (!audioCtx) return;
      if (audioCtx.state === 'suspended') audioCtx.resume();

      const now = audioCtx.currentTime;
      const beep = (freq, start, dur) => {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = 'sine'; osc.frequency.value = freq;
        osc.connect(gain); gain.connect(audioCtx.destination);
        gain.gain.setValueAtTime(0.0001, now + start);
        gain.gain.exponentialRampToValueAtTime(0.35, now + start + 0.02);
        gain.gain.exponentialRampToValueAtTime(0.0001, now + start + dur);
        osc.start(now + start); osc.stop(now + start + dur);
      };
      beep(880, 0.00, 0.28);
      beep(880, 0.45, 0.28);
      beep(880, 0.90, 0.45);
    }

    document.addEventListener('keydown', function(e) {
      if (e.code === "Space") {
        if (document.exitFullscreen) document.exitFullscreen().catch(()=>{});
        window.close();
      }
    });
  </script>
</body>
</html>
